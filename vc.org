#+TITLE: Version control
#+STARTUP: hideblocks
* Version control

  #+begin_src emacs-lisp
    (use-package magit :ensure magit :commands magit-status)

    (defun magit-revision-file-log (revision file &optional use-graph)
      "Display the log for the currently visited file or another one for a specific revision.
    With a prefix argument show the log graph."
      (interactive
       (let* ((rev (magit-read-rev "Revision" (or (magit-guess-branch) "HEAD")))
              (file (magit-read-file-from-rev rev (magit-buffer-file-name t))))
         (list rev file)))
      (magit-mode-setup magit-log-buffer-name nil
                        #'magit-log-mode
                        #'magit-refresh-log-buffer
                        'oneline revision
                        `(,@(and use-graph (list "--graph"))
                          ,@magit-custom-options
                          "--follow")
                        file))
  #+end_src
